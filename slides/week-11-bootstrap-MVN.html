<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Multiple Linear Regression</title>
    <meta charset="utf-8" />
    <meta name="author" content="Math 392" />
    <link href="libs/remark-css-0.0.1/fc.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/fc-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <script src="libs/jquery-1.11.3/jquery.min.js"></script>
    <link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="reed.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Multiple Linear Regression
## The Bootstrap, MVN
### Math 392

---





# Resampling methods: two methods

There are two general approaches to getting bootstrap intervals for your regression estimates (for `\(\beta\)`, `\(\hat{E}(Y|X)\)`, `\([Y|X]\)`):

1. Bootstrap the **cases**.
2. Bootstrap the **residuals**.

---
# Aside:

Bootstrap is not a good idea when your you have few observations, let's simulate a data set of moderate size.


```r
set.seed(8134)
n &lt;- 35
x0 &lt;- 1
x1 &lt;- rnorm(n)
x2 &lt;- rnorm(n)
X &lt;- as.matrix(data.frame(x0, x1, x2))
B &lt;- c(-3, .5, 2)
sig_sq &lt;- 2.25
epsilon &lt;- rnorm(n, mean = 0, sd = sqrt(sig_sq))
Y &lt;- X %*% B + epsilon
df &lt;- data.frame(X, Y)
```


---
# Bootstrap the cases


```r
b1 &lt;- sample_frac(df, replace = TRUE)
head(b1)
```

```
##   x0          x1         x2         Y
## 1  1  0.83535656  0.1209323 -2.536903
## 2  1  0.07239619 -1.8961143 -7.910420
## 3  1 -0.25058242 -1.3210614 -3.608330
## 4  1 -0.74282899 -1.1589374 -3.755188
## 5  1 -0.96462888 -0.1406838 -3.856865
## 6  1  0.57466246 -1.1905117 -4.296790
```

```r
b2 &lt;- sample_frac(df, replace = TRUE)
head(b2)
```

```
##   x0         x1          x2          Y
## 1  1  0.5631423 -0.82051067 -3.4623495
## 2  1  2.0582999 -1.24876981 -4.4920737
## 3  1 -0.2023860  0.06540560 -0.8649449
## 4  1  2.0582999 -1.24876981 -4.4920737
## 5  1  0.8353566  0.12093227 -2.5369027
## 6  1  0.6973097  0.04931632 -2.6266855
```


---
# Compute estimates for each b


```r
mb1 &lt;- lm(Y ~ x1 + x2, data = b1)
coef(mb1)
```

```
## (Intercept)          x1          x2 
## -2.88886682 -0.05040406  1.57162276
```

```r
mb2 &lt;- lm(Y ~ x1 + x2, data = b2)
coef(mb2)
```

```
## (Intercept)          x1          x2 
##  -2.8203529   0.5830797   1.9925660
```


---
# Full bootstrap


```r
it &lt;- 5000
beta_hp &lt;- rep(NA, it)
for (i in 1:it) {
  b &lt;- sample_frac(df, replace = TRUE)
  beta_hp[i] &lt;- lm(Y ~ x1 + x2, data = b)$coef[2]
}
sd(beta_hp)
```

```
## [1] 0.1955991
```

```r
m1 &lt;- lm(Y ~ x1 + x2, data = df)
summary(m1)$coef
```

```
##               Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept) -3.0149299  0.2057590 -14.652724 9.591452e-16
## x1           0.4959268  0.2034211   2.437932 2.050589e-02
## x2           1.5608675  0.1950372   8.002922 3.894623e-09
```


---
# Thoughts on that... 

It seemed to work fine but it is a bit odd because the bootstrap procedure suggests that *both* the `\(X\)` and the `\(Y\)` are random variables.

Can we devise a procedure that is in closer accordance with our idea of regression as conditioning on the values of `\(X\)`?

*After conditioning on the values of `\(X\)`, `\(Y\)` is only random through the random vector `\(\epsilon\)`. Why don't we bootstrap that?*

`$$\mathbf{Y} = X\beta + \mathbf{\epsilon}$$`

---
# Bootstrap Residuals visualized

---
# Bootstrap residuals


```r
it &lt;- 5000
beta_hp &lt;- rep(NA, it)
m1 &lt;- lm(Y ~ x1 + x2, data = df)
b &lt;- df
for (i in 1:it) {
  b$Y &lt;- m1$fit + sample(m1$res, replace = TRUE)
  beta_hp[i] &lt;- lm(Y ~ x1 + x2, data = b)$coef[2]
}
sd(beta_hp)
```

```
## [1] 0.1930897
```

```r
summary(m1)$coef
```

```
##               Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept) -3.0149299  0.2057590 -14.652724 9.591452e-16
## x1           0.4959268  0.2034211   2.437932 2.050589e-02
## x2           1.5608675  0.1950372   8.002922 3.894623e-09
```

---
# Guidance on using the bootstrap

- If you are confident that you have the correct *mean function*, bootstrapping the residuals is more appropriate.

- If you have no idea about the form of the mean function, bootstrapping the cases is the safer / more conservative approach.


---
# The Multivariate Normal Distribution

We can write *any* linear estimator as

`$$\hat{\beta} = CY$$`

Therefore `\(\hat{\beta}\)` is a linear combination of the `\(Y\)`. If we assume

$$
Y \sim N(X\beta, \epsilon)
$$

Then we know (through MGFs) that `\(\hat{\beta}\)` is also normally distributed. More specifically, when `\(C = (X'X)^{-1}X'\)`,

$$
\hat{\beta} \sim N(\beta, \sigma^2(X'X)^{-1})
$$

---
# The Multivariate Normal Distribution, cont.



The general form of the multivariate Normal distribution is

$$
\boldsymbol{X} \sim N(\boldsymbol{\mu}, \boldsymbol{\Sigma})
$$
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

Where `\(\boldsymbol{X}\)` is a `\(n \times p\)` matrix, `\(\boldsymbol{\mu}\)` is a `\(p \times 1\)` mean vector, and `\(\boldsymbol{\Sigma}\)` is a `\(p \times p\)` variance/covariance matrix.

You can access densities and random number generated for this distribution via the `dmvnorm()` and `rmvnorm()` functions


```r
library(mvtnorm)
rmvnorm(n, mean = mu, sigma = Sigma)
```

---
# Simulating from MVN

First, specify parameters,


```r
mu_vec &lt;- c(1, 2, 3)
sigma_mat &lt;- matrix(c(.5,  0, .7,
                       0, .5,  0,
                      .7,  0,  2),
                    ncol = 3, byrow = TRUE)
sigma_mat
```

```
##      [,1] [,2] [,3]
## [1,]  0.5  0.0  0.7
## [2,]  0.0  0.5  0.0
## [3,]  0.7  0.0  2.0
```

---
# Simulating from MVN, cont.

then, generate random variables.




```r
rmvnorm(1, mean = mu_vec, sigma = sigma_mat)
```

```
##           [,1]      [,2]     [,3]
## [1,] 0.2138873 0.4631653 2.079299
```

```r
rmvnorm(1, mean = mu_vec, sigma = sigma_mat)
```

```
##          [,1]     [,2]     [,3]
## [1,] 1.223988 2.113755 3.117293
```

```r
rmvnorm(10, mean = mu_vec, sigma = sigma_mat)
```

```
##             [,1]      [,2]     [,3]
##  [1,] 0.48087366 2.8899896 2.889368
##  [2,] 1.29128984 2.5380857 4.171362
##  [3,] 1.34164338 1.5339317 4.110056
##  [4,] 1.31996910 0.5135465 3.566813
##  [5,] 0.01468775 1.2799916 1.300745
##  [6,] 1.01529290 1.9279481 2.973339
##  [7,] 1.38404369 2.8238943 3.733078
##  [8,] 0.68423316 0.5464896 3.220507
##  [9,] 0.61221955 2.0238233 3.004848
## [10,] 0.16797158 1.5428333 2.185705
```

---
# Visualizing the MVN


```r
X &lt;- rmvnorm(100, mean = mu_vec, sigma = sigma_mat)
library(GGally)
ggpairs(as.data.frame(X))
```

&lt;img src="week-11-bootstrap-MVN_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;

---
# Two ways to view a dataset `\(Y\)`

- `\(n\)` iid draws from `\(N(\mu, \sigma^2)\)`

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

- One draw from `\(N(\mu_n, \sum_{n\times n})\)`

---
# Small example `\((n = 3)\)`


```r
set.seed(8134)
n &lt;- 3
x0 &lt;- 1
x1 &lt;- rnorm(n)
x2 &lt;- rnorm(n)
x3 &lt;- rnorm(n)
x4 &lt;- rnorm(n)
X &lt;- as.matrix(data.frame(x0, x1, x2, x3, x4))
B &lt;- c(-3, .5, 2, 1, -.8)
sig_sq &lt;- 2.25
epsilon &lt;- rnorm(n, mean = 0, sd = sqrt(sig_sq))
Y &lt;- X %*% B + epsilon
df &lt;- data.frame(Y, X)
df
```

```
##           Y x0          x1         x2          x3          x4
## 1 -2.420069  1 -0.54789199  0.6245961 -0.07552716  0.02026105
## 2 -4.114054  1 -0.06456819 -1.4713007  0.49497462 -0.39986583
## 3 -3.087447  1 -0.25058242 -0.9935656  0.34607212 -1.02113706
```

---
# Three iid scalar draws

A partial view:

&lt;img src="week-11-bootstrap-MVN_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

---
# One vector draw

<div id="htmlwidget-63d3d7a84fbd9cfc1c57" style="width:504px;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-63d3d7a84fbd9cfc1c57">{"x":{"visdat":{"3d8174c44546":["function () ","plotlyVisDat"]},"cur_data":"3d8174c44546","attrs":{"3d8174c44546":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Y1"},"yaxis":{"title":"Y2"},"zaxis":{"title":"Y3"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-2.4200688155674],"y":[-4.11405374296316],"z":[-3.08744693563163],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---
# What does hypothetical resampling look like?

&lt;img src="week-11-bootstrap-MVN_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;

---
# 10 vector draws

<div id="htmlwidget-aa05cbe59287ef74db8b" style="width:504px;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-aa05cbe59287ef74db8b">{"x":{"visdat":{"3d81762e8293":["function () ","plotlyVisDat"]},"cur_data":"3d81762e8293","attrs":{"3d81762e8293":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Y1"},"yaxis":{"title":"Y2"},"zaxis":{"title":"Y3"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.118681722881533,-2.52612862540673,-2.01838137209204,-2.0425152781378,-3.90225728075194,-4.96066114150135,-1.61655630344412,2.0481479803201,-3.347255769864,0.0593279169046981],"y":[-4.42966422447697,-1.37957554847942,-3.85489582079154,-3.98964448324294,-3.36468214823568,-2.3275154265395,-5.12939626135817,-2.45609527135406,-2.39343071937834,-2.24487216647914],"z":[-2.33876926316912,-1.3365706875146,-3.67702434901627,-2.17341676541279,-1.93509136582861,-2.75384973429385,-0.591801240961771,0.0425943251151613,-3.32680624163037,-1.67629670661891],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---
# 300 vector draws

<div id="htmlwidget-d86bdca783bf1b9eea14" style="width:504px;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d86bdca783bf1b9eea14">{"x":{"visdat":{"3d8131cbd6e3":["function () ","plotlyVisDat"]},"cur_data":"3d8131cbd6e3","attrs":{"3d8131cbd6e3":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Y1"},"yaxis":{"title":"Y2"},"zaxis":{"title":"Y3"}},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-1.8589956670591,-3.76123226568507,-2.75798273508703,-2.69571676184992,-1.92876885190693,-3.70325882916004,-1.60331985636384,-0.0110528577330395,-2.19046271981322,-1.31958806120211,-3.27087888381268,0.523373152378729,-3.39276758677186,-1.2193890698122,-3.91088909562718,-1.83462728229476,-1.18116452240891,-0.182388672288299,-2.14017379487601,-2.19678566924047,-2.2096727696969,-0.0471487794658767,-1.72918926098874,-4.14751364513977,-3.73551591050462,-1.74421803583364,-1.11297471922863,-2.15601277182717,-2.31930792316348,-2.31293530698132,-3.8240597305377,-0.985085415454204,-2.04905678097234,-1.85956628658471,-1.45198179317446,-3.29780957851665,-1.36371787280521,-2.00785554857518,-1.68122172012637,-3.69015740669089,-3.74374030959794,-1.19662909806816,-3.11155608010665,-2.2254291707677,-2.79785366371408,-4.39016177587465,-1.55941604355085,-1.14753925143665,-0.499025409009549,-5.31987215268401,-2.05295512608665,-2.69214719226098,-2.91646493078005,-3.04481984131547,-1.53552516098323,-2.20073207173511,-3.33565404487306,-1.50158865776158,-2.94020757050514,-2.78765275576514,-3.49032976168231,-4.78908919004713,-2.79961191220062,-4.14231581026556,-3.57248172809896,-3.15912390541392,-1.83421843621113,-2.08114636789373,-3.72083145301857,-5.57546890631984,-1.24485461929155,-2.41567112984819,-2.2783518769493,-3.07777532831756,-2.34355601731071,-0.742914325710471,-3.69681440109588,-1.00750225539948,-3.69210429258658,-1.6597003163958,-3.57308006819189,-5.47797726386877,1.85448324906314,-3.5215123433152,-2.420031191042,-2.52557389734572,-3.46967043026541,-4.95539334194295,-2.57478799861145,-4.88746471623149,-2.02274260050876,-3.96704047071319,-1.3094106452399,-0.352779449622016,-4.27867862315471,-0.0298164287926657,-2.85841014722864,-0.222745749224345,-3.09520694090035,-1.05383148991446,-0.68804393575405,-1.69675913647818,-1.84902578006686,-2.66100839062618,-4.28948995461439,-2.25370588114047,-1.67015753268004,-1.21441357181178,-4.36548136404321,-1.15100362650737,0.954439890755556,-3.75340058188869,-2.7367024155541,-2.6030609530389,-3.30948731377348,-3.07914699444654,-3.55799067930991,-4.2500358633304,-1.88704060563174,-3.69103141989344,-2.65923186577953,-0.165982307515639,-2.58782223879275,-4.26772380581396,-1.1196411466448,-0.831564333037182,-1.30383743624427,-1.99748809895419,-1.76897988034281,-4.37239082236249,-3.76368667443125,-0.808707222845458,-3.06159781649395,-2.47223819617076,-1.71642371625503,-3.24266688580803,-0.522242872175881,-2.68102042447229,-3.52151736369257,-4.90767575777337,-3.51398252902264,-0.193885350755438,-2.08770343092046,-0.945354086890146,-1.39178525509219,-2.07443121868486,1.07374741489072,-3.16746329253864,-0.0766599450896619,-0.893150475278241,-1.24737586738297,-2.65064598186926,-4.24489090257668,-2.86684157887653,-4.75066806394243,0.335596992824712,-2.80812053900663,0.0591094873725133,-0.700140389754705,-0.640444702730936,-0.247898394864184,-1.92552660389954,-2.72201630541401,0.708825879867538,-1.95067053672721,-1.98719297869034,-1.16737919892234,-2.60519660739593,-1.31242351015237,-1.24408721248371,-2.11100674185513,-3.44594877208748,-1.2176057833052,-1.33326693937804,-1.04545738986939,-2.17055319017674,-2.82214872641808,-1.60499813598648,-1.50522900838381,-2.84780424250437,-2.89675613541846,-1.35848734492594,-3.04550163447057,-3.79112277712328,-2.33622351935532,-1.32058989189753,0.758227652705879,-0.210491204335129,-2.47935154655752,-3.40563279708033,-3.66070849551402,-1.02529516260645,-2.40426862436136,-4.55004737210814,0.387807182822369,-2.79310078355472,-2.73283024432027,-3.55611840272271,-2.12398942890112,-2.80042506009888,-1.55673648899134,-1.92165264190323,-0.558350179064195,-0.761516637273823,-3.98865394299224,-2.15066320565985,-2.39337904488712,-2.81601277872629,-2.67764636501166,-2.23889172501625,-5.22234338403566,-0.557497026540744,-3.1418780839065,-3.56401131275317,-1.2734895952626,-3.55090755469701,-3.99008192214102,-1.27975218527748,-2.80050268411125,-2.25956931618044,-2.19405617813638,-4.40730467001037,-3.52333647253317,-0.717574995610787,0.350570827773136,-3.39950499793995,0.37619623177942,-0.883387313560804,0.904126450916924,-3.59643486180058,-3.38554684494573,-1.58882924596148,-1.67981375464082,-3.12970805953635,0.467918816618605,-1.633537955655,-4.69843831248815,-2.0031462557095,-2.41946386050352,-3.34847958038313,-5.71175622862969,-1.274975779796,-3.14841459133483,-0.757529865521314,0.936956199625516,-3.43912026103144,-3.89519109643364,-1.96640900071055,-2.92529582764302,-0.980468616503247,-3.03990207432016,-2.98340359098493,1.59866818839873,-0.257864768749815,-0.900953329054981,-1.88780582370148,-1.59635477253994,-1.772765389801,-2.05710451382451,0.329669349477593,-1.52233745194312,-0.249950933336013,-3.63079997992137,-2.51157951575036,0.410282629740866,-2.15930916901436,-3.71661503531587,-2.56717874671715,-1.22392711803943,-2.7721866566527,-2.88130236479206,-1.36446506099294,-1.17852484372021,-1.29101238893909,-2.81831696550538,-3.67334675341396,-3.16116923256604,-0.869965769609944,-0.678998851572372,-2.51626044756967,-3.25598996724639,-1.23431766511588,-1.59618510835787,-0.776511891498345,-3.28396234182133,-4.17327183181785,0.955977958782006,-2.97763474809411,-1.49208647754902,-1.22069229240227,-0.774102361532003,-4.42806305556892,-1.64436301441888,-3.13691330818721,-2.31172862534062,-1.68604279352077,-0.139803295028469,-2.91329147972939,-2.92127144355425,-1.72533327536088],"y":[-3.45632839741605,-1.70149493585709,-0.365469227780954,-1.58250082112779,-1.68627901614927,-3.29555261752627,-2.01722888901972,-2.08920472728698,-0.303275094858496,-3.82913212416115,-1.33569280147202,-2.55233265705867,-4.1992694437864,-1.47375372746007,-1.42902259799169,-2.15356244587091,-4.86940931824161,-5.54458820048623,-1.31637059683618,-2.93417782503079,-1.59703734956554,-0.811416536348097,-0.861859540800179,-3.18374289104284,-1.49309994124246,-2.53551901157184,-2.96744596062158,-2.04988015191107,-1.16619585156352,-0.17407091437434,-0.887845401226406,-1.24033116781434,-2.67895087048102,-0.825568095319195,-2.45191072545549,-3.30365033845654,-3.65440864844915,-4.40161234105605,-3.44723652457394,-0.446542900314072,-2.13631220721335,-2.67516081777551,-0.389496567133695,-3.48413108094778,-2.64500083083596,-2.30817845578745,-3.89738066997532,-0.373216633784867,-2.46856113143192,-3.94892243145527,-3.34902993685182,-2.77436068412762,-3.45357340144364,-2.32597503040266,-1.43920482767259,-3.75886996110876,-2.50960641242963,1.11054218294872,-2.73935338270109,-5.2359577018349,-3.27511053511751,-2.72551196019963,-3.68368388250389,-3.97722904449227,-2.32385847446972,-2.11671278404941,-1.10123526127578,-1.07361468585874,-2.61492754034191,-2.29800833908335,-0.633045263538994,-2.32647726574373,-0.677907072414387,-1.84739662525083,-3.50822010596422,-0.937743683052239,-2.64961208410985,-3.18292314963607,-3.27920491094036,-1.46269577643876,-1.4827104519631,-0.629361501646696,-3.29345494857909,1.20956559038984,-1.20725077996417,-3.4231975298381,-0.896811691230252,-1.74557441446868,-0.533894323087737,-2.98946625698105,-2.04393909395333,-1.24823234327059,-0.827441882724732,-1.86639966855897,-2.75614372885096,-1.27208406528574,-3.11602806470699,-2.57324969164805,-1.17593712255445,-0.900436835253074,-2.26131114030325,-5.45910835029236,-3.3139300841539,-1.98907792322568,-3.9927896813587,-2.79748170268128,-1.9676175612244,-1.56574236708663,-3.66213077727335,-2.29086841949245,-0.128377071249588,-1.73674666606431,-1.66131210759566,-1.34127180504955,-1.40957573732653,-1.47796572056385,-4.32564712084938,-2.67803345807891,-1.89972310026491,-2.31713690751851,-6.04255890206556,-2.7931805206706,-3.69394692293511,-2.79985805423589,-3.65147594037865,0.0210259059539428,-3.21470460260545,-3.00843123940173,-1.79437334148254,-2.60508473409314,-5.11049191383394,-1.98441512134028,-2.73126666708762,-5.83535123280887,0.0404096418275857,-0.613402326304902,-2.69777914031581,-0.391500182505283,-1.54311476182361,-5.07019262653117,-1.75538798757702,-2.0827194243651,-1.53310398232583,-2.89190065371005,-2.64797512317944,-2.88126039115968,-3.81407263546668,-1.78425339604266,-0.225902823703572,-6.76162077310019,-4.35128072801007,-2.50431819718526,-2.45187807521898,-3.17075006288094,-3.12828093048525,-3.15335466392661,0.350187259780946,-2.02027342031992,-0.435719690099638,-1.4416184459184,-3.2174435258322,-1.9827326162012,-1.98065492548844,-1.65092832621302,-1.47735771483714,-3.92151448568826,-1.04948947894558,-3.21813192178381,-2.77974241569129,-1.89315110735425,-3.29036504780573,-2.60054095905529,-1.11075670107877,-3.87800051154802,-1.59607612331078,-3.86878465177749,-3.08012494867824,-3.55405362375408,-1.9210799753726,-4.43215568580596,-0.899796858687679,1.68403618895634,-0.0734674592584592,-1.25143701061448,-1.87804565431842,-0.92963261108376,-2.9518158089965,-5.06074195193345,-2.3180758655566,-3.66542375622392,-4.05686435209176,-4.15973487320676,-4.95890319970979,-3.93819518529274,-2.80921838015472,-2.9273073807335,-3.40356623668262,-2.11815977077465,-2.50806011403444,-3.88785554440918,-1.70684147740232,-0.967154007856478,-1.14033869158064,-2.3142786175141,-1.42492065507931,-5.44794374651694,-3.6055551176192,-3.82329474991787,-4.48773039239171,-2.47198916710367,-3.08462137135486,-2.81582547871115,-1.49052076700113,-2.68910839041898,-1.16120334023151,-2.21533855888406,-1.25450845757316,-4.49275076909725,-0.363495828814435,-1.11898080195956,-0.0937432527312967,-2.76812590487133,-3.33016157184118,-2.57107780344614,-2.93653589735867,-4.17584375074941,-0.919442647356701,-3.10685136481357,-4.13830662530693,-6.41264599624463,-1.59399902140963,-0.557629683680776,-4.557653455984,0.656910118709124,-2.78471971336813,-3.83082030910404,-3.41673123948048,-1.40939642525835,-3.36388813839719,-3.38091253462555,-5.64546613202365,-0.831010900452934,-3.9823918009975,-2.5358477002402,-1.23337042385216,-0.940410300047061,-0.944644424843093,-0.92332394246032,-2.03531499687716,-2.04291444845735,-1.56223590687156,-0.675601677302213,-0.882703053145119,-1.10241829076416,-3.37639590181936,1.46058770097049,-3.32813468992603,-2.4894429888439,-2.82534150693936,-1.81236567460823,0.414071721607754,-1.99747857920115,-1.98472063315093,-1.11791783213603,0.512187153130401,-1.9270231126226,-3.6258312924288,-3.26974374460609,-4.39313230116212,-2.17754901005738,-4.68080656984468,-4.31288285191942,-1.99112643256763,-4.16669335690736,-0.0505371591695365,0.352302824598122,-1.99725239866315,0.126171899494434,-1.01029243606763,-3.62867560019952,-2.12649570253182,-1.5507026912654,-3.23268838365606,-1.31589841617852,0.781405363128039,-3.30065778333631,-5.55112320815117,-0.166350066134397,0.289310197259316,-2.72281103100521,-0.742787656075586,-2.85365642044544,-2.91575396937665,-0.800438558417197,-5.57116014368265,-2.94811709848616,-1.16693131512674,0.88151403731282,-3.11679031453274,-2.40436931302707],"z":[-2.87960358864507,-2.34953766420388,-2.03656860764592,-2.83021506703291,-4.07569021884925,-3.91150822929038,-0.051233184453138,-0.242237579479754,-0.480778164558693,-1.31786447918715,-0.388894081587518,-1.69795249715789,-3.64648670245379,-0.348820427401005,-3.96040883162592,-3.7465308602649,0.516161767999049,-0.955432212938955,-1.05611991383097,-0.139213358404898,-1.49156469023845,0.726185102498365,-2.44584630988517,-0.983498440989867,-0.142020837487916,-2.69088295735288,-0.486524393153101,-2.60806734936697,-2.83563831980602,-0.839802910714013,-0.754320932765695,-0.320401099314284,0.0263193898905181,-2.01402440589636,-2.36105588475191,-2.8744720292749,-3.33728603875895,-1.08043284730492,-4.1596691072231,-0.771551982376099,-7.09900381607948,-2.19078335019013,-2.22441549771877,-1.81567907794175,-3.00831518107128,-5.179695706298,-4.87494386593352,-1.92062836116015,-3.51584165502479,-1.68498189300073,-2.03817081067289,-1.61468323951816,-3.46458468704107,-1.68878572301291,0.326538560027554,0.141598587996084,-1.86780474573656,-3.41577004258545,-2.23155919904398,-2.87206502433869,0.529305881031582,-1.70065027991314,-2.65995161627735,-1.33695546601019,-2.16397586879307,-1.11339913586256,-4.64508818591244,1.27350418784792,-0.919440198939958,-3.69923924170096,-4.91259786946443,-3.00056693140848,-2.43360246644011,-2.23784053111438,-4.9507501836462,-3.86398773746413,-1.84470637965998,0.929900801268973,-3.88127403594412,-2.02864298812,-3.71347323405484,-2.54774045826645,-1.88196714488513,-1.15328410113482,-2.75088560548922,-2.49963531136338,-3.32309330165103,-1.64831323681928,-3.27799398983067,-0.0435967154734058,-0.965461318666818,-0.46355442538918,-2.4995550634062,-0.577161556684826,-0.761400728113192,-0.870232708720949,-0.19633674089612,-1.48643024792977,1.1858056327678,-3.07122577135841,-2.02689732795829,-0.84520210270457,-0.122478045814989,-2.64618428568912,-3.8031064472594,-0.763021705288509,-2.57364096755621,-1.51939372568584,-0.997888207089117,-2.57357712908047,-0.667069691009519,-3.95216619199869,-1.12329782389655,-1.98380051305268,-1.53337178469333,-0.975767077273554,-3.03636894717833,-2.53245889552993,-4.00894398455584,-0.194459125410901,-2.82933333712443,-1.5772561330128,-0.853211176467255,0.808246640971124,-0.613980211349916,-1.66259842688873,-2.35614944775848,-2.75194199228003,-2.59910247835951,-0.815041529977981,-0.382669560880905,-2.59664844316488,-3.54360639924796,-0.197022551155804,-3.89274616915167,-2.27383456831225,-0.763917567257282,-2.58183879031346,-2.32993628032295,-3.36132774200815,-1.4756269938712,-4.69204587197919,-3.15665249066466,-0.427980528998176,-5.33694315466543,-1.63799724389797,-1.32866364778668,-1.41636113653857,-3.50431658610391,-2.42301735280146,-5.30831460381425,-2.11050451167858,-0.17568891223409,1.556698110942,-2.95797119635732,-1.45286171136928,-3.15274260918303,-3.32494742536334,-1.69232839924466,-1.33750743429247,-1.10932581578947,-3.02161819960054,-1.77734770823552,0.690392523174347,0.369059923474524,-0.0918441671880372,-1.06064751702054,-2.07059323491495,-3.00576257149536,-2.0121141741659,-2.26821575123862,1.34259474917397,1.0070545348605,-3.64094653981558,-1.03043783438723,-2.60630405695162,-5.4016773341004,-2.24305759392707,-2.0436301422073,-4.31602817471196,-1.66699102984877,-0.525917686759132,-0.115825751867259,-2.44321913689418,0.202177972494512,-2.2639688204426,-1.42677347721662,-2.6771383162675,-1.8185084878462,-3.10165057449532,-1.85146639448221,-1.06135076869997,-3.87281435510487,-2.83259617618959,-4.37156946566781,-2.3416949317983,-0.502620557710767,1.4827019649394,-2.98858286867407,1.11965364278315,-3.21566749815659,1.31925070688106,-1.31271923077608,0.639082942382327,-4.45828138205439,-2.83678442075858,-1.59653345380297,-1.67273411343987,-2.29686274679881,0.548182914262842,-5.26402725271102,-3.05026388921872,-1.8082009413311,-4.43168188527723,-1.22951236607237,-6.75405228787446,0.13824542718603,-2.81864357716264,-2.69002725924624,-2.6425224173213,-1.84393193791697,-0.0877166824799911,-2.77865215849871,0.123925097703005,-0.363000032355001,-1.76889272162809,-3.87332871033182,-6.92036189783784,-2.8185997873442,-1.37073342232845,-1.43146284038512,-1.70684109294916,-3.64728406101924,-3.35545391445202,-0.324473857749709,-1.06100868923697,-3.16955631767143,-1.64514604811428,-2.9365186894328,-2.53462762429893,-1.47982341259468,-2.34132408412983,-2.11739585577474,-4.03503441024623,-3.65143166079691,-1.62018161951419,-3.53873248896459,-0.974781537249576,-1.23469299306359,-3.30041013698672,-5.25779089003765,-3.66581570339455,-1.45069718539351,-3.1541598791683,-2.98423723869729,-2.27697279104304,-1.67244365818246,0.179897320103551,-3.33254292472476,-2.5426295600745,-4.43987869945,-0.945447620897322,-0.172505212965741,-2.80926532039947,-4.08317388129469,-1.51748120548234,-2.48722418880597,-1.74797136006419,-2.23421844925681,-0.822213403919292,-3.80448308346163,-3.45376801072577,0.479481367961709,-4.0974027914488,-3.37053482476896,-2.09204733982715,-0.938659362788041,-1.05137895279722,-1.12318052902908,-2.69945081558799,-4.67768338234886,-3.18954779642625,-3.14436188298926,-0.0257872430383541,-2.70086285244263,-2.02053102267817,-1.88433596899006,-3.12447065595936,1.05103164566184,-2.41776218602116,-3.33485643710617,-0.382207502764868,-3.27590651761594,-3.54209069668505,-3.3519381492599,-1.8715501129235,-3.82134553503346,-0.388940795218666,-4.56616607732401,-4.71573897055888],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "atelier-forest-light",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
